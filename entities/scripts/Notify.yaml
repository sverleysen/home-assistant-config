notify:
  alias: Notify
  icon: mdi:bell-ring
  description: 'Notify all the required devices'
  fields:
    message:
      description: 'De melding die gestuurd moet worden'
      example: "Test melding"
    title:
      description: 'De titel van de melding'
      example: "Test titel"
    tts:
      description: "moet TTS gebruikt worden?"
      example: "false"
    persistant:
      description: "Persistant notification maken?"
      example: "false"
  sequence:
    - service: notify.file_logger
      data_template:
        message: "{{now().strftime('%d/%m/%Y %H:%M:%S')}} {{title}} - {{ message }}"
    - choose:
      - conditions: 
        - condition: template
          value_template: "{{ persistant }}"
        sequence:
          - service: persistent_notification.create
            data_template:
              title: "{{ title }}"
              message: "{{now().strftime('%H:%M:%S')}} {{ message }}"
    - service: notify.all_devices
      data_template:
        title: "{{ title }}"
        message: "{{now().strftime('%H:%M:%S')}} {{ message }}"
    - service: notify.all_android_devices
      data_template:
        title: "{{ title }}"
        message:  "{{now().strftime('%H:%M:%S')}} {{ message }}"
        data:
          channel: "{{ title }}"
          ttl: 0
          importance: high
    - service: script.notify_tts
      data_template:
        message:  "{{ message }}"
        tts: "{{ tts }}"